.registers {
    A, B, C, D <- 3x3 builtin (30, 18, 10, 9)
}

input "Which Fibonacci number to calculate: " D
if solved D {
    halt "The number is: 0"
}
inc B
loop {
    dec D
    if solved D {
        halt "The number is: " B
    }
    while not-solved B {
        sub B 1
        add A 1
        add C 1
    }
    dec D
    if solved D {
        halt "The number is: " A
    }
    while not-solved A {
        sub A 1
        add C 1
        add B 1
    }
    fib-shuffle C B A D
    dec D
    if solved D {
        halt "The number is: " C
    }
    while not-solved C {
        sub C 1
        add B 1
        add A 1
    }
}
